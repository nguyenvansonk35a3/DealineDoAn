<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Star Admin Premium Bootstrap Admin Dashboard Template</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="../assets/vendors/iconfonts/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="../assets/vendors/iconfonts/ionicons/css/ionicons.css">
    <link rel="stylesheet" href="../assets/vendors/iconfonts/typicons/src/font/typicons.css">
    <link rel="stylesheet" href="../assets/vendors/iconfonts/flag-icon-css/css/flag-icon.min.css">
    <link rel="stylesheet" href="../assets/vendors/css/vendor.bundle.base.css">
    <link rel="stylesheet" href="../assets/vendors/css/vendor.bundle.addons.css">
    <!-- endinject -->
    <!-- plugin css for this page -->
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="../assets/css/shared/style.css">
    <!-- endinject -->
    <!-- Layout styles -->
    <link rel="stylesheet" href="../assets/css/demo_1/style.css">
    <!-- End Layout styles -->
    <link rel="shortcut icon" href="../assets/images/favicon.png" />
  </head>
  <body>
    <div class="container-scroller">
      <!-- partial:partials/_navbar.html -->
       <nav class="navbar default-layout col-lg-12 col-12 p-0 fixed-top d-flex flex-row" th:replace="manager/fragment/listNav::nav"></nav>
      <!-- partial -->
      <div class="container-fluid page-body-wrapper">
        <!-- partial:partials/_sidebar.html -->
        <nav class="sidebar sidebar-offcanvas" id="sidebar" th:replace="manager/fragment/listNav_1::nav_1"></nav>
        <!-- partial -->
        <div class="main-panel">
          <div class="content-wrapper">
           <div class="row">
              
             
              <div class="col-lg-12 grid-margin stretch-card">
                <div class="card">
                  <div class="card-body">
                    <h4 class="card-title">Danh Sách Danh Mục</h4>
                    <p class="card-description"> 
                    <a class="btn btn-inverse-success btn-fw" th:href="@{/manager/addCategory}">Thêm Danh Mục</a> 
                    </p>
                    
                    <table id="dataTable-listCategory" class="table table-hover">
                      <thead>
                        <tr>
                          <th> Tên Danh Mục </th>
                          <th></th>
                        </tr>
                      </thead>
                      <tbody id="dataCategory">
                      
                         <tr th:each = "ca : ${category}">
                          <td id="nameCategory-${ca.idCategory}" th:text ="${ca.name}"></td>
                          <td>
                              <button class="btn btn-info"  data-toggle="modal" data-target="#updateCategory" onclick="setDataUpdateCategory('${ca.idCategory}')">Cập Nhập</button>
                              <button class="btn btn-danger" data-toggle="modal" data-target="#deleteCategory" onclick="setDataDeleteProduct('$(ca.idCategory)')">Xóa</button>
                          </td>
                          
                        </tr> 
                      
                      </tbody>
                    </table>
                  </div>
                </div>
             
              
              </div>
            </div>
          </div>
           <footer class="footer" th:replace="manager/fragment/footer::footer"></footer>
          <!-- partial -->
        </div>
        <!-- main-panel ends -->
      </div>
      <!-- page-body-wrapper ends -->
    </div>
    
    <!-- Modal -->
		
    
		 <div id="addCategory" class="modal fade" role="dialog">
		  <div class="modal-dialog">
		
		    <!-- Modal content-->
		    <div class="modal-content">
		      <div class="modal-header">
		        <h4 class="modal-title">Danh Mục</h4>
		      </div>
		      <div class="modal-body">
		        <p>Thêm danh mục</p>
		        
		        <div class="form-group">
				    <label for="exampleInputEmail1">Tên Danh Mục</label>
				    <input type="email" class="form-control" id="nameAddCategory" placeholder="nhập tên danh mục">
				 </div>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-primary" onclick="addAjaxCategory()" data-dismiss="modal">Lưu</button>
		        <button type="button" class="btn btn-secondary" data-dismiss="modal">Thoát</button>
		      </div>
		    </div>
		
		  </div>
		</div>
		
		<!-- updateCategory -->
		
		<div id="updateCategory" class="modal fade" role="dialog">
		  <div class="modal-dialog">
		
		    <!-- Modal content-->
		    <div class="modal-content">
		      <div class="modal-header">
		        <h4 class="modal-title">Danh Mục</h4>
		      </div>
		      <div class="modal-body">
		        <p>Sửa danh mục</p>
		        <input type="hidden" id="idUpdateCategory">
		        <div class="form-group">
				    <label for="exampleInputEmail1">Tên Danh Mục</label>
				    <input type="text" class="form-control" id="nameUpdateCategory">
				 </div>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-primary" onclick="updateAjaxCategory()" data-dismiss="modal">Lưu</button>
		        <button type="button" class="btn btn-secondary" data-dismiss="modal">Thoát</button>
		      </div>
		    </div>
		
		  </div>
		</div>
		
		<!-- deleteCategory -->
		
		<div id="deleteCategory" class="modal fade" role="dialog">
		  <div class="modal-dialog">
		
		    <!-- Modal content-->
		    <div class="modal-content">
		      <div class="modal-header">
		        <h4 class="modal-title">Bạn thật sự muốn xóa thông tin này</h4>
		      </div>
		      <div class="modal-footer">
		      <input type="hidden" id="idCategoryDelete" />
		        <button type="button" class="btn btn-primary" onclick="deleteAjaxCategory()" data-dismiss="modal">Xóa</button>
		        <button type="button" class="btn btn-secondary" data-dismiss="modal">Không</button>
		      </div>
		    </div>
		
		  </div>
		</div>
    
    
    <script src="https://code.jquery.com/jquery-3.4.1.js"
			  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
			  crossorigin="anonymous"></script>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="../assets/vendors/js/vendor.bundle.base.js"></script>
    <script src="../assets/vendors/js/vendor.bundle.addons.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page-->
    <!-- End plugin js for this page-->
    <!-- inject:js -->
    <script src="../assets/js/shared/off-canvas.js"></script>
    <script src="../assets/js/shared/misc.js"></script>
    <!-- endinject -->
    <!-- Custom js for this page-->
    <script src="../assets/js/demo_1/dashboard.js"></script>
    <!-- End custom js for this page-->
    
    <!-- DataTables -->
	<script th:src="@{/assets/vendors/datatables/jquery.dataTables.js}"></script>
	<script th:src="@{/assets/vendors/datatables/dataTables.bootstrap4.js}"></script>
	<script type="text/javascript">
		/* $(document).ready(function() {
			$('#dataTable-listCategory').DataTable({
				"lengthChange" : false,
				"info" : false,
				"pageLength" : 2
			});
		}); */
		
		/* $( document ).ready(function() {
			showListCategory();
		});
		
		function showListCategory(){
			$.ajax({
				type : "GET",
				contentType : "application/json; charset=utf-8",
				dataType : 'json',
				url : "/manager/listCategoryAjax",
				success : function(result){
					listHtml(result);
				},
				error: function(result){
					
					console.log(result);
					alert('failedd');
				}
			});
		}
		function listHtml(result){
			var listCategory = result;
			
			if(listCategory == null){
				alert("Failed");
			}else{
				$('#dataCategory').empty();
				
				$.each(listCategory, function(i, item){
					
					var html = '<tr>'
				 	 +'<td id="idCategory-'+item.idCategory+'">'+item.idCategory+'</td>' 
                    +'<td id="nameCategory-'+item.idCategory+'">'+item.name+'</td>'
                    +'<td>'
                        +'<button class="btn btn-info" onclick="setDataUpdateCategory('+item.idCategory+')" data-toggle="modal" data-target="#updateCategory">Cập Nhập</button>'
                        +'<button class="btn btn-danger" data-toggle="modal" data-target="#deleteCategory" onclick="setDataDeleteProduct('+item.idCategory+')">Xóa</button>'
                    +'</td>'
                  +'</tr>';
					
					$('#dataCategory').append(html);
				});
			}
		}
		function addAjaxCategory(){
			var dataCategory = {
				"name" : $('#nameAddCategory').val()
			};
			$.ajax({
				type: "POST",
				contentType : "application/json; charset=utf-8",
				dataType : 'json',
				url : "/manager/addAjaxCategory",
				data : JSON.stringify(dataCategory),
				success : function(result){
					listHtml(result);
				},
				error: function(result){
					alert('failedd');
				}
			});
		}
		
		function setDataUpdateCategory(categoryId){
			$('#idUpdateCategory').val($('#idCategory-' +categoryId).text());
			$('#nameUpdateCategory').val($('#nameCategory-' +categoryId).text());
		}
		
		function updateAjaxCategory(){
			debugger;	
			var dataCategory = {
					"idCategory" : parseInt($('#idUpdateCategory').val()),
					"name" : $('#nameUpdateCategory').val()
			}
			$.ajax({
				type : "POST",
				contentType : "application/json; charset=utf-8",
				dataType : 'json',
				url : "/manager/updateAjaxCategory",
				data : JSON.stringify(dataCategory),
				success : function(result){
					listHtml(result);
				},
				error: function(result){
					alert('failed');
				}
			});
		}
		function setDataDeleteProduct(categoryId){
			$('#idCategoryDelete').val($('#idCategory-'+categoryId).text());
		}
		function deleteAjaxCategory(){
			var idCategory = parseInt($('#idCategoryDelete').parent().find('#idCategoryDelete').val());
			$.ajax({
				type : "POST",
				contentType : "application/json; charset=utf-8",
				dataType : 'json',
				url : "/manager/deleteAjaxCategory/" +idCategory,
				success : function(result){
					listHtml(result);
				},
				error : function(result){
					 alert('failed');
				}
				
				
			});
		} */
	</script>
  </body>
</html>